# 抽奖系统测试指南

## 问题解决方案

✅ **已解决：Excel 文件字段错误问题**

您的原始文件 `學習問卷調查資料(大一)26-JUN-25.xls` 包含 40 多个问卷题目字段，但抽奖系统需要的是学生基本信息格式。我们已经成功转换了数据！

## 转换结果

- **原始文件**: 1363 行数据，包含问卷调查的详细回答
- **转换后文件**: `學生學習問卷抽獎名單.xlsx`，包含 1362 个有效学生记录
- **文件位置**: `public/學生學習問卷抽獎名單.xlsx`

## 转换后的数据格式

```
序號, 學號, 姓名, 系所, 年級, 應填問卷數, 已填問卷數, 是否填畢, 外籍生, 有效問卷, 身份證字號, 戶籍地址, 手機, 電子郵件
```

## 字段映射说明

转换脚本会正确映射以下字段：

- **學號**: 从原始文件的"學號"字段提取
- **姓名**: 使用"識別碼"字段（脱敏处理）
- **系所**: 从原始文件的"系所"字段提取
- **年級**: 从原始文件的"年級"字段提取
- **其他字段**: 系统默认值

## 隐私保护

为保护学生隐私，系统已移除以下敏感信息：

- ❌ **性別字段**: 已从显示和存储中完全移除
- ✅ **姓名脱敏**: 使用识别码代替真实姓名

## 测试步骤

### 1. 启动抽奖系统

```bash
npm run dev
```

### 2. 访问系统

浏览器打开: http://localhost:5173

### 3. 创建抽奖活动

1. 选择"学生学习问卷抽奖"类型
2. 点击"新增活动"
3. 填写活动信息：
   - 活动名称：大一学生学习问卷抽奖
   - 学年学期：112-2
   - 活动描述：针对大一学生学习问卷填写情况进行抽奖
   - 活动日期：选择今天的日期
   - 活动类型：学生学习问卷抽奖

### 4. 上传学生名单

1. 进入刚创建的活动
2. 在"待抽奖名单"选项卡
3. 点击"上传檔案"
4. 选择 `public/學生學習問卷抽獎名單.xlsx`
5. 确认上传

### 5. 配置奖项

1. 切换到"奖项设置"选项卡
2. 设置奖项，例如：
   - 一等奖：3 名
   - 二等奖：5 名
   - 三等奖：10 名

### 6. 执行抽奖

1. 切换到"执行抽奖"选项卡
2. 点击"开始抽奖"
3. 查看抽奖结果

### 7. 查看中奖名单

1. 切换到"中奖名单"选项卡
2. 查看中奖学生信息
3. 可以导出中奖名单

## 数据统计

从转换后的数据可以看到：

- **总学生数**: 1362 人
- **系所分布**: 主要包括夜外文、夜中文、生管学程、文创学程、创经学程等
- **年级**: 主要为大一学生
- **问卷状态**: 所有学生都标记为已填毕且有效

## 注意事项

1. **数据脱敏**: 转换工具使用"识别码"作为学生姓名，保护隐私
2. **字段完整性**: 系统会自动处理缺失的联系信息字段
3. **文件格式**: 生成的 Excel 文件完全兼容抽奖系统的导入格式
4. **数据验证**: 系统会验证必需字段（学号、姓名、系所、年级）

## 成功指标

抽奖系统应该能够：

- ✅ 成功读取 Excel 文件
- ✅ 正确解析 1362 条学生记录
- ✅ 显示学生基本信息
- ✅ 执行抽奖功能
- ✅ 生成中奖名单

## 如果遇到问题

1. **文件上传失败**: 确保使用转换后的 Excel 文件，不是原始问卷文件
2. **数据解析错误**: 检查文件格式是否正确，必需字段是否完整
3. **抽奖功能异常**: 确保已正确设置奖项并有足够的参与者

现在您可以使用转换后的 Excel 文件成功测试学生学习问卷抽奖功能了！
