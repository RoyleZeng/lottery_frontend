# 学生问卷数据转换工具

## 问题说明

您的 Excel 文件 `學習問卷調查資料(大一)26-JUN-25.xls` 包含了原始的问卷调查数据，包含 40 多个字段（问卷题目），但抽奖系统期望的是一个标准格式的学生基本信息表。

## 字段映射对比

### 您的原始文件字段：

```
學號, 識別碼, 年級, 性別, 學院, 系所, 入學管道, q1_1_a, q1_1_b, q1_1_c, ... (40+个问卷题目字段)
```

### 抽奖系统期望的字段：

```
序號, 學號, 姓名, 系所, 年級, 應填問卷數, 已填問卷數, 是否填畢, 外籍生, 有效問卷, 身份證字號, 戶籍地址, 手機, 電子郵件
```

## 使用转换工具

### 1. 安装依赖

```bash
cd scripts
npm install
```

### 2. 复制您的 Excel 文件

将 `學習問卷調查資料(大一)26-JUN-25.xls` 文件复制到 `scripts` 目录中

### 3. 运行转换

```bash
npm run convert
```

### 4. 使用转换后的文件

转换完成后会生成 `學生學習問卷抽獎名單.xlsx` 文件，您可以使用这个文件上传到抽奖系统。

## 转换规则

- **學號**: 直接从原始文件的"學號"字段提取
- **姓名**: 使用"識別碼"字段（脱敏处理）
- **系所**: 直接从原始文件的"系所"字段提取
- **年級**: 直接从原始文件的"年級"字段提取
- **應填問卷數**: 设置为 1（表示每个学生应填 1 份问卷）
- **已填問卷數**: 设置为 1（因为有数据就表示已填写）
- **是否填畢**: 设置为'Y'（表示已填毕）
- **外籍生**: 默认设置为'N'
- **有效問卷**: 设置为'Y'（表示有效问卷）
- **联系信息**: 原始文件中没有，留空

## 注意事项

1. 转换工具会自动处理数据格式问题
2. 跳过没有学号的记录
3. 生成的 Excel 文件符合抽奖系统的导入格式要求
4. 转换后的文件可以直接用于"学生学习问卷抽奖"活动类型

## 手动创建样本文件（备选方案）

如果转换工具无法使用，您也可以手动创建一个 Excel 文件，包含以下列：

| 序號 | 學號       | 姓名   | 系所   | 年級 | 應填問卷數 | 已填問卷數 | 是否填畢 | 外籍生 | 有效問卷 | 身份證字號 | 戶籍地址 | 手機 | 電子郵件 |
| ---- | ---------- | ------ | ------ | ---- | ---------- | ---------- | -------- | ------ | -------- | ---------- | -------- | ---- | -------- |
| 1    | 3112043020 | 學生 1 | 夜外文 | 1    | 1          | 1          | Y        | N      | Y        |            |          |      |          |
| 2    | 3113042001 | 學生 2 | 夜中文 | 1    | 1          | 1          | Y        | N      | Y        |            |          |      |          |

其中必填字段为：學號、姓名、系所、年級。
